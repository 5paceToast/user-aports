# Contributor: Chloe Kudryavtsev <toast@toastin.space>
# Maintainer: Chloe Kudryavtsev <toast@toastin.space>
pkgname=bat
pkgver=0.10.0
pkgrel=0
pkgdesc="A cat(1) clone with wings"
url="https://github.com/sharkdp/bat"
arch="all"
license="MIT Apache-2.0"
depends=""
makedepends="cargo"
install=""
subpackages="$pkgname-doc"
source="$pkgname-$pkgver.tar.gz::https://github.com/sharkdp/$pkgname/archive/v$pkgver.tar.gz"
builddir="$srcdir/$pkgname-$pkgver"

export CARGO_HOME="$srcdir"/cargo
export RUSTFLAGS="-C target-feature=-crt-static"

build() {
	cd "$builddir"
	mkdir "$builddir"/out
	cargo build \
		--release \
		--verbose
}

check() {
	cd "$builddir"
	cargo test --all \
		--release \
		--verbose
}

package() {
	cd "$builddir"
	install -m755 -D target/release/bat "$pkgdir/usr/bin/$pkgname"
	install -m644 -D doc/bat.1 "$pkgdir/usr/share/man/man1/$pkgname.1"
}

sha512sums="65913c7d3e504c32b157036b4418775a8a4d6dc60e45f8b6c3d26cae98fdac7f956d54caf1c5ef662b378a41479d527a71bb78de3ab11446b9be41cc8a580dbd  bat-0.10.0.tar.gz"
